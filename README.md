# Xandaris - 4X Space Strategy Game

A numbers-only 4X-lite space strategy game built with vanilla JavaScript and Canvas, featuring crypto server banking and real-time multiplayer.

## Features

- **Real-time 4X gameplay** with 10-second ticks
- **Crypto server banking** with passive income
- **Player-driven economy** with trade routes
- **Colony management** and fleet operations
- **Canvas-based map** with smooth zoom and pan
- **Real-time updates** via WebSocket
- **Discord OAuth** authentication

## Tech Stack

- **Frontend**: Vanilla JS + Canvas + Tailwind CSS
- **Backend**: PocketBase (Go + SQLite)
- **Auth**: Discord OAuth2
- **Real-time**: WebSocket
- **Build**: Vite
- **Note**: Project is structured with separate `frontend` and `backend` directories.

## Getting Started

### Prerequisites

- Node.js 18+
- Go 1.20+ (for backend)

### Backend Setup

1. Set up environment (from project root):
```bash
cp .env.example .env
# Ensure your .env file has the necessary variables for PocketBase.
# The backend, when run from the `backend/` directory, might need to be configured
# or environment variables set for it to pick up `../.env`.
# PocketBase typically loads .env files automatically if they exist in its execution directory.
```

2. Run the backend (from project root):
```bash
cd backend
go mod tidy # To ensure dependencies are downloaded
go run cmd/main.go
# The backend server will start, typically on port 8090.
# Migrations are applied automatically.
# To seed data (optional): go run cmd/seed/main.go
cd ..
```

### Frontend Setup

1. Install frontend dependencies (from project root):
```bash
cd frontend
npm install
```

2. Start development server (usually on http://localhost:5173):
```bash
npm run dev
cd ..
```

The app will be available at `http://localhost:5173`

### Building for Production

```bash
# From the project root
cd frontend
npm run build
cd ..
```

Output will be in the `backend/pb_public/` directory, ready to be served by the PocketBase backend.

## Game Mechanics

### Core Gameplay
- **Systems**: Colonize and develop star systems
- **Resources**: Food, ore, goods, fuel, credits
- **Buildings**: Habitats, farms, mines, factories, shipyards
- **Fleets**: Send military forces between systems
- **Trade**: Create automated cargo routes
- **Diplomacy**: Form alliances and treaties

### Controls
- **Mouse**: Pan map, select systems, right-click for context menu
- **Wheel**: Zoom in/out
- **Keyboard Shortcuts**:
  - `F`: Send fleet from selected system
  - `T`: Create trade route from selected system
  - `B`: Build in selected system
  - `C`: Center on selected system
  - `H`: Fit all systems in view
  - `ESC`: Close modals/menus

## Project Structure

```
.
├── frontend/
│   ├── src/                # Frontend source (JS, CSS, components)
│   │   ├── lib/
│   │   │   └── pocketbase.js
│   │   ├── stores/
│   │   │   └── gameState.js
│   │   ├── components/
│   │   │   ├── mapRenderer.js
│   │   │   └── uiController.js
│   │   ├── styles.css
│   │   └── main.js
│   ├── static/             # Static assets (e.g., favicon)
│   ├── index.html          # Main HTML entry point
│   ├── package.json        # Frontend dependencies and scripts
│   └── vite.config.js      # Vite configuration
├── backend/
│   ├── cmd/                # Main application and seeder entry points
│   │   ├── main.go
│   │   └── seed/
│   │       └── main.go
│   ├── internal/           # Internal Go packages (business logic)
│   ├── migrations/         # Database migrations
│   ├── pkg/                # Public Go packages (e.g., handlers)
│   ├── go.mod              # Backend Go module definition
│   ├── go.sum              # Backend Go module checksums
│   └── pb_public/          # (Generated by frontend build) Static frontend assets
├── .env.example            # Example environment variables
├── .gitignore
└── README.md
```

## API Integration

The frontend expects these PocketBase collections:
- `users` - Player accounts
- `systems` - Star systems with coordinates
- `planet_types` - Templates for planet generation
- `planets` - Planets belonging to systems
- `building_types` - Available building templates
- `buildings` - Constructed buildings on planets
- `resource_types` - Types of resources
- `resource_nodes` - Resource deposits on planets
- `populations` - Player population units
- `fleets` - Moving groups of ships
- `ship_types` - Templates for ships
- `ships` - Ships belonging to fleets
- `trade_routes` - Automated cargo transport
- `treaties` - Diplomatic agreements

And these API endpoints:
- `GET /map` - Initial map data
- `POST /orders/fleet` - Send fleet
- `POST /orders/build` - Queue building
- `POST /orders/trade` - Create trade route
- `POST /diplomacy` - Propose treaty
- `WS /stream` - Real-time updates

## Development

This project follows the patterns established in the vibe-chuck reference project:
- Component-based architecture
- Store-based state management
- Real-time data synchronization
- Responsive design with Tailwind
- Modal-based interactions

## License

MIT